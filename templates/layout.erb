# >---------------------------------------------------------------------------<
# 
#                   ___               ____             ____  
#                  / _ | ___  ___    / __/__________  / / /__
#                 / __ |/ _ \/ _ \  _\ \/ __/ __/ _ \/ / (_-<
#                /_/ |_/ .__/ .__/ /___/\__/_/  \___/_/_/___/
#                     /_/  /_/                               
#
#   This template was generated by App Scrolls, the amazing and awesome Rails
#     application template builder. Get started at http://appscrolls.org
#
# >---------------------------------------------------------------------------<

# >----------------------------[ Initial Setup ]------------------------------<

initializer 'generators.rb', <<-RUBY
Rails.application.config.generators do |g|
end
RUBY

@scrolls = <%= resolve_scrolls.map(&:key).inspect %> 
use_git = @scrolls.include?('git')

<%= render "helpers" %>

<% resolve_scrolls.each do |scroll| %>
<%= render 'scroll', scroll.get_binding %>
<% end %>


say_wizard "Running before_everything callbacks."
@before_everything_blocks.each do |b|
  execute_block(b)
  git_commit("recipe : '#{b.first}'") if use_git
end

<% if custom_code? %># >-----------------------------[ Custom Code ]-------------------------------<

<%= custom_code %><% end %>

@current_scroll = nil

# >-----------------------------[ Run Bundler ]-------------------------------<

say_wizard "Running Bundler install. This will take a while."
run 'bundle install'
git_commit("bundle install") if use_git


say_wizard "Running after Bundler callbacks."
@after_blocks.each do |b|
  execute_block(b)
  git_commit("recipe : '#{b.first}'") if use_git
end

@current_scroll = nil
say_wizard "Running after_everything callbacks."
@after_everything_blocks.each do |b|
  execute_block(b)
  git_commit("recipe : '#{b.first}'") if use_git
end


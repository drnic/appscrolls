# >---------------------------------------------------------------------------<
# 
#                   ___               ____             ____  
#                  / _ | ___  ___    / __/__________  / / /__
#                 / __ |/ _ \/ _ \  _\ \/ __/ __/ _ \/ / (_-<
#                /_/ |_/ .__/ .__/ /___/\__/_/  \___/_/_/___/
#                     /_/  /_/                               
#
#   This template was generated by App Scrolls, the amazing and awesome Rails
#     application template builder. Get started at http://appscrolls.org
#
# >---------------------------------------------------------------------------<

# >----------------------------[ Initial Setup ]------------------------------<

initializer 'generators.rb', <<-RUBY
Rails.application.config.generators do |g|
end
RUBY

@scrolls = <%= resolve_scrolls.map(&:key).inspect %> 

<%= render "helpers" %>

<% resolve_scrolls.each do |scroll| %>
<%= render 'scroll', scroll.get_binding %>
<% end %>


# >-------------------[ Run before everything callbacks ]---------------------<
say_wizard "Running before_everything callbacks."
@before_everything_blocks.each do |b|
  execute_block(b)
end
@current_scroll = nil


<% if custom_code? %>
# >-----------------------------[ Custom Code ]-------------------------------<
<%= custom_code %>
scm_commit "after custom code"
@current_scroll = nil
<% end %>


# >-----------------------------[ Run Bundler ]-------------------------------<
# Vendor everything: http://ryan.mcgeary.org/2011/02/09/vendor-everything-still-applies/
say_wizard "Running Bundler install. This will take a while."
run 'bundle install --path vendor/bundle'
run 'echo "vendor/bundle/ruby\n" >> .gitignore'
scm_commit "after bundle install"


# >---------------------[ Run after Bundler callbacks ]-----------------------<
say_wizard "Running after_bundler callbacks."
@after_blocks.each do |b|
  execute_block(b)
  scm_commit "after_bundler for scroll '#{b.first}'"
end
@current_scroll = nil


# >--------------------[ Run after everything callbacks ]----------------------<
say_wizard "Running after_everything callbacks."
@after_everything_blocks.each do |b|
  execute_block(b)
  scm_commit "after_everything for scroll '#{b.first}'"
end
@current_scroll = nil

